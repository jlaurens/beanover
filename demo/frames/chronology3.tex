% !TeX encoding = UTF-8
% !TeX program = lualatex
% !TeX root = ../demo.tex


\begin{tikzpicture} [
  x=\baselineskip,
  y=0.85\baselineskip,
]
  \tikzset {
    slide label/.style = {
      minimum height=1.5\baselineskip,
      font=\footnotesize,
    },
    my code/.style = {
      text distance=0.5\baselineskip,
      fill=white,
      draw,
      font=\ttfamily\small,
    },
  }
  \coordinate (O) at (0,0);
  \coordinate (I) at (1,0);
  \visible<?(Sticky1.2)-> {
    \draw [-{Stealth}] (O) -- ($16*(I)$);
    \foreach \x in {1,...,8} {
      \draw (\directlua{tex.print(2*\x-1)},-2pt) -- (\directlua{tex.print(2*\x-1)},2pt);
    }
    \node [slide label] at (0.5,0) [anchor=north east]{Slide: };
    \foreach \x in {1,...,8} {
      \node [slide label] at (\directlua{tex.print(2*\x-1)},0) [anchor=north]{\x};
    }
  }
  \visible<?(Sticky1.4)-> {
    \node [slide label] at (0.5,12) [anchor=east]{Air:};
    \node [slide label] at (0.5,11) [anchor=east]{Chameleo:};
    \node [slide label] at (0.5,10) [anchor=east]{Gannet:};
    \node [slide label] at (0.5,9) [anchor=east]{Water:};
    \node [slide label] at (0.5,8) [anchor=east]{Octopus:};
    \node [slide label] at (0.5,7) [anchor=east]{Starfish:};
    \node [slide label] at (0.5,6) [anchor=east]{Picasso:};
    \node [slide label] at (15.5,9) [anchor=west]{\rotatebox{45}{Texts}};
    \foreach \x in {1,...,8} {
      \foreach \y in {6,...,12} {
        \fill [lightgray]  (\directlua{tex.print(2*\x-1)},\y) circle(2pt);
      }
    }
  }
  \visible<?(Sticky1.6)-> {
    \draw [dotted] (-2.5,5.5) -- (16,5.5);
    \node [slide label] at (0.5,5) [anchor=east]{Chameleo:};
    \node [slide label] at (0.5,4) [anchor=east]{Gannet:};
    \node [slide label] at (0.5,3) [anchor=east]{Octopus:};
    \node [slide label] at (0.5,2) [anchor=east]{Starfish:};
    \node [slide label] at (0.5,1) [anchor=east]{Picasso:};
    \node [slide label] at (15.5,3) [anchor=west]{\rotatebox{45}{Images}};
    \foreach \x in {1,...,8} {
      \foreach \y in {1,...,5} {
        \draw [fill=lightgray] (\directlua{tex.print(2*\x-1)},\y) +(-1.75pt,-1.75pt) [lightgray]  rectangle +(1.75pt,1.75pt);
      }
    }
  }
  \visible<?(Sticky1.8)-> {
    \foreach \y in {6,...,12} {
      \foreach \x in {\directlua{tex.print(13-\y)},...,8} {
        \fill [blue]  (\directlua{tex.print(2*\x-1)},\y) circle(2.5pt);
      }
    }
  }
  \visible<?(Sticky1.10)-> {
    \foreach \y in {5} {
      \foreach \x in {2,3,8} {
        \draw [draw=none,fill=orange] (\directlua{tex.print(2*\x-1)},\y) +(-2pt,-2pt) rectangle +(2pt,2pt);
      }
    }
    \foreach \y in {4} {
      \foreach \x in {3,8} {
        \draw [draw=none,fill=orange] (\directlua{tex.print(2*\x-1)},\y) +(-2pt,-2pt) rectangle +(2pt,2pt);
      }
    }
    \foreach \y in {3,2,1} {
      \foreach \x in {\directlua{tex.print(8-\y)},...,8} {
        \draw [draw=none,fill=orange] (\directlua{tex.print(2*\x-1)},\y) +(-2pt,-2pt) rectangle +(2pt,2pt);
      }
    }
  }
  \visible<?(Sticky1.12)-> {
    \foreach \y in {5} {
      \foreach \x in {3} {
        \draw [draw=none,fill=magenta] (\directlua{tex.print(2*\x-1)},\y) +(-2pt,-2pt) rectangle +(2pt,2pt);
      }
    }
    \foreach \y in {3,2} {
      \foreach \x in {\directlua{tex.print(9-\y)},...,7} {
        \draw [draw=none,fill=magenta] (\directlua{tex.print(2*\x-1)},\y) +(-2pt,-2pt) rectangle +(2pt,2pt);
      }
    }
  }
  \begin{scope} [overlay]
    \visible<?(Sticky2.3)-> {
      \node [slide label] at (3,12.5) [anchor=south]{\rotatebox{45}{%
        \only<?(CodeAir.range)>{\bfseries\color{MyGreen}}%
          Air%
        }%
      };
      \draw [dashed, lightgray] (0.55,0.55) rectangle (5.45,12.45);
    }
    \visible<?(Sticky2.4)-> {
      \node [slide label] at (10,12.5) [anchor=south]{\rotatebox{45}{%
        \only<?(CodeWater.range)>{\bfseries\color{MyGreen}}%
          Water%
        }%
      };
      \draw [dashed, lightgray] (6.55,0.55) rectangle (13.45,12.45);
    }
    \visible<?(Sticky2.5)-> {
      \node [slide label] at (15,12.5) [anchor=south]{\rotatebox{45}{%
        \only<?(CodeSummary.range)>{\bfseries\color{MyGreen}}%
          Summary%
        }
      };
      \draw [dashed, lightgray] (14.55,0.55) rectangle (15.45,12.45);
    }
  \end{scope}
\end{tikzpicture}%
%%%
\Sticky<?(Sticky1:6)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.75\textwidth}\bfseries%
• We had 8 slides\visible<?(Sticky1.3)->{ for 7 texts}\visible<?(Sticky1.5)->{ and 5 images}%
\end{minipage}}%
\Sticky<?(Sticky1.7:2)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.75\textwidth}\bfseries%
• Blue dots for uncovered text%
\end{minipage}}%
\Sticky<?(Sticky1.9:2)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.75\textwidth}{\bfseries%
• orange squares for uncovered images
}\end{minipage}}%
\Sticky<?(Sticky1.11:2)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.85\textwidth}{\bfseries%
• magenta squares for uncovered transparent images
}\end{minipage}}%
\Sticky<?(Sticky2.1)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.75\textwidth}{\bfseries%
Let us organize all this
}\end{minipage}}%
\Sticky<?(Sticky2.2:4)>[anchor=south,yshift=1\baselineskip](current page.south){\begin{minipage}{0.85\textwidth}{\bfseries%
• 3 slides for the Air, 4 for the Water, 1 to summarize
}\end{minipage}}%
\visible<?(Code.range, Usage.range)> {%
  \tikz [
    remember picture,
    overlay,
  ] {
    \node [
      yshift=2\baselineskip,
      xshift=-2\baselineskip,
      anchor=east,
    ] at (current page.east) [text width=0.8\textwidth] {%
\begin{myCodeBox}{l}%
\string\Beanoves \{\\
\phantom{xx}{\only<?(Code.range)>{\bfseries\color{MyGreen}}\rlap{Air}\phantom{Summary} = 1 : 3,}\\
\phantom{xx}{\only<?(CodeWater.range)>{\bfseries\color{MyGreen}}\rlap{Water}\phantom{Summary} = Air.next : 4,}\\
\phantom{xx}{\only<?(CodeSummary.range)>{\bfseries\color{MyGreen}}Summary = Water.next : 1,}\\
\}
\end{myCodeBox}
    }%
  }
}%
%
\Sticky<?(Code.1)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.75\textwidth}}
• This code declares the logical overlay ranges\\
• At the top of the frame source
\end{tabular}}%
\Sticky<?(CodeAir.range)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.75\textwidth}}
• \texttt{\bfseries{Air}} is a variable like name\\
• \texttt{\bfseries{1}} is the position of the first slide\\
• \texttt{\bfseries{3}} is the duration (or length) of the range
\end{tabular}}%
\Sticky<?(CodeWater.range)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.75\textwidth}}
• The "Water" topic follows the "Air" topic:\\
• \texttt{\bfseries{Air.next}} is the first slide after the \texttt{Air} range\\
• \texttt{\bfseries{4}} is the duration (or length)
\end{tabular}}%
\Sticky<?(CodeSummary.range)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.75\textwidth}}
• The "Summary" follows the "Water" topic:\\
• \texttt{\bfseries{Water.next}} is the first slide after the \texttt{Water} range
\end{tabular}}%
\Sticky<?(Usage)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.75\textwidth}}
To limit "Air" topic images to the \texttt{Air} and \texttt{Summary} ranges,
use a logical overlay specification...
\end{tabular}}%
\only<?(Usage.range)> {
  \tikz [
    remember picture,
    overlay,
  ] {
    \node [
      yshift=-1.5\baselineskip,
      xshift=-1\baselineskip,
      anchor=east,
    ] at (current page.east) [text width=0.8\textwidth] {%
\begin{myCodeBox}{l}
\string\only <%
\textcolor{MyGreen}{\bfseries?(Air.range)},%
  \textcolor{MyGreen}{\bfseries?(Summary.range)}%
> \{\\
\phantom{xx}\% code to display the images...\\
\}
\end{myCodeBox}
    }%
  }
}%
%%
\Sticky<?(Usage.2)>[anchor=south,yshift=1\baselineskip](current page.south){\bfseries\begin{tabular}{p{0.85\textwidth}}%
• \textcolor{MyGreen}{\texttt{\bfseries?(Air.range)}} is automatically replaced by \textcolor{MyGreen}{\bfseries\texttt{1-3}}\\
• \textcolor{MyGreen}{\texttt{\bfseries?(Summary.range)}} is automatically replaced by \textcolor{MyGreen}{\bfseries\texttt{8-8}}
\end{tabular}}%
%%%%

